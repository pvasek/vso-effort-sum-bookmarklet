<!DOCTYPE html>
<html>
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
		<title>VSO effort sum bookmarklet</title>
	</head>
<body>
	<div class="container">
		<h3>
		Bookmarklet which sums up effort for all selected PBIs on the backlog list.
		</h3>
		<p>
			<ol>
				<li>Drag this button to your bookmark bar <a class="btn btn-primary" href="javascript:(function showEffortSum() {     var count = 0;     var content = '';     var selectedRowsSelectors = [        '.productbacklog-grid-results .grid-row-selected',        '.productbacklog-grid-results .grid-row-selected-blur',    ];    var headerSelector = '.grid-header .grid-header-column';    var cellSelector = 'grid-cell';    var columns = document        .querySelectorAll(headerSelector);    var effortIndex = -1;    for (var i = 0; i < columns.length; i++) {        if (columns[i].getAttribute('title') === 'Effort') {            effortIndex = i;            break;        }    }            if (effortIndex === -1) {        alert('Sorry, cannot locate effort index');        return;    }    console.log('efforIndex: ', effortIndex);    document        .querySelectorAll(selectedRowsSelectors.join(', '))        .forEach(function(i) {             var divs = i.querySelectorAll(cellSelector);            var effortDiv = divs[effortIndex];            console.log('effortDiv: ', effortDiv);             if (effortDiv && effortDiv.textContent) {                 var effortText = effortDiv.textContent;                 if (effortText && effortText.trim() !== '') {                     count += parseInt(effortText, 10);                 }             }         });     alert(count); })()">Effort Sum</a></li>
				<li>Go to your backlog</li>
				<li>Select PBIs/Bugs you want sum up effort for</li>
				<li>Click to your "Effort Sum" link in bookmarks</li>
			</ol>
		</p>
		<p>
			The source code can be found here: 
			<a href='https://github.com/pvasek/vso-effort-sum-bookmarklet'>https://github.com/pvasek/vso-effort-sum-bookmarklet</a>
		</p>
		<p>
			
		</p>
	</div>
<body>
</html>